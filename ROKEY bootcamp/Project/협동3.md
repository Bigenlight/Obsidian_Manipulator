
#rokey실습
[[로봇 프로젝트]]
last modification: 2024-12-17

[GitHub - Bigenlight/Parking\_Tower\_with\_Giant\_Manipulator](https://github.com/Bigenlight/Parking_Tower_with_Giant_Manipulator)

[https://docs.google.com/presentation/d/18IFaGdIbW4buoX8C6MJ5DYHKFh-3p1f_8huu_Eum8EI/edit?usp=sharing](https://docs.google.com/presentation/d/18IFaGdIbW4buoX8C6MJ5DYHKFh-3p1f_8huu_Eum8EI/edit?usp=sharing)

[[Drawing 2024-12-23 13.59.01.excalidraw]]
[[Drawing 2024-12-23 11.59.53.excalidraw]]

sudo apt install ros-humble-moveit

참고로 devian 패키지 보다 source로 설치해서 빌드하는게 더 무거움...
그러니 패키지가 크고 컴퓨터 성능이 좋은게 아니면 소스 설치는 피하는게 좋을 수도 있음.

[[로키 - 두산 프로젝트 교안(RVIZ2)_김루진_1217.pdf]]

![[협동3_presentation.pptx]]
# 프로젝트
  
로봇 2대, 3대. 최소 2대임.
Slam 맵 상에서 작동이 보여야함. 미니맵에서 보여야 함.
자율주행만 한 조도 있었음
매니퓰레이터, 드론을 쓴 사람들도 있었음
moveit2를 써본 조도 있었음, 근데 잘 안됐음

교도소 감시 로봇을 만든 조도 있었음. 하지만 맵이 너무 단순해서 맵이 안 그려졌음. 맵은 적당히 복잡해야


# 명령어 모음

ros2 launch turtlebot3_multi_robot mani_multi_nav2_world.launch.py  
  
ros2 run robot_control_gui skynet  
  
ros2 launch arduinobot_controller controller.launch.py  
  
ros2 launch arduinobot_moveit moveit.launch.py  
  
ros2 launch arduinobot_remote remote_interface.launch.py  
  
ros2 run multi_turtlebot_nav goal_sender  
+  
  

---

ros2 launch arduinobot_description gazebo.launch.py  
  
  
ros2 action send_goal /task_server arduinobot_msgs/action/ArduinobotTask "task_number: 0"  
  
ros2 action send_goal /task_server arduinobot_msgs/action/ArduinobotTask "task_number: 1"  
  
ros2 topic pub /arm_state std_msgs/String "data: 'port arrived'"  
  
ros2 service call /ATTACHLINK linkattacher_msgs/srv/AttachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'tb1', link2_name: 'tb1::base_link'}"  
  
ros2 service call /DETACHLINK linkattacher_msgs/srv/DetachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'tb1', link2_name: 'tb1::base_link'}"  
  

# 노드토픽 구조

로봇팔노드 :  
pub:  
/arm_state : 이동 완료 시 'tower arrived' / 'port arrived'  
sub:  
/destination : 0~9의 int  
/turtlebot_state : 터틀봇 도착 여부. 'tb1 arrived' / 'tb2 arrived'  

---

관제노드(skynet) :  
pub:  
tb1/cmd_vel : 터틀봇(tb1) 이동 명령  
tb1/cmd_vel : 터틀봇(tb2) 이동 명령  
/destination : 0~9의 int. 'port'에서 'tower'로 출발할 때 publish.  
sub:  
/turtlebot_state : 터틀봇 도착 여부.  
/arm_state : 이동 완료 시 'tower arrived' / 'port arrived'  

---

터틀봇노드 :  
pub:  
/turtlebot_state : 터틀봇 도착 여부. 'tb1 arrived' / 'tb2 arrived'  
  
  

---

# 명령어

---

# term1

cd  
cd multitb_ws  
cb  
inst  
ros2 launch turtlebot3_multi_robot gazebo_multi_nav2_world.launch.py  
  

# term2

cd  
cd 7_ws  
cb  
inst  
ros2 run robot_control_gui skynet  
  

# term3

cd  
cd 7_ws  
cb  
inst  
ros2 run robot_control_gui test  

# GIT

[https://github.com/Bigenlight/Parking_Tower_with_Giant_Manipulator](https://github.com/Bigenlight/Parking_Tower_with_Giant_Manipulator)  
mkdir 7_ws  
cd 7_ws  
git clone [git@github.com](mailto:git@github.com):Bigenlight/Parking_Tower_with_Giant_Manipulator.git  
rokey@rokey-550XBE-350XBE:~/7_ws$ ros2 run robot_control_gui robot_control_gui  
Warning: Ignoring XDG_SESSION_TYPE=wayland on Gnome. Use QT_QPA_PLATFORM=wayland to run on Wayland anyway.


폴더명을 src로 변경  

alias 7pull='cd && cd 7_ws/src/ && git pull origin main && cd && cd 7_ws/'  
alias 7push='cd && cd 7_ws/src/ && git add . && git commit -m "최태오 커밋" && git push -u origin main && cd && cd 7_ws/'

**_ros2 launch turtlebot3_multi_robot gazebo_multi_nav2_world.launch.py_**  
ros2 run multi_turtlebot_nav turtlebot_state_monitor  
ros2 run multi_turtlebot_nav goal_sender

![[map (1).yaml]]
![[map (1).pgm]]

터틀봇3 설치
![[image (3).png]]

[[프로젝트 교안(터틀봇3를 이용한 서비스 및 관제 프로그램 개발)_1115 (1).pdf]]

터틀봇3 기본 패키지  
https://emanual.robotis.com/docs/en/platform/turtlebot3/quick-start/#pc-setup  
터틀봇 가제보 시뮬레이션  
https://emanual.robotis.com/docs/en/platform/turtlebot3/simulation/#gazebo-simulation  
cd turtlebot3_ws  
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py  
ros2 run turtlebot3_teleop teleop_keyboard  
  
house.world 수정 ← car.world 집어넣기  
런치 파일 높이 바꾸기  
car.world world 폴더로  
models다 models 폴더로

###### namespace 중심으로 로봇 2개 이상

시나리오를 만들고, 그에 맞는 로봇

화성탐사, 정비, 공장 등

시나리오에 맞는 맵 - 가져와도 됨
연출(침입자 등장, spawn 등)

차동이동로봇 2개 이상
그중에서 하나는 개조 또는 모델링. 개조 추천, 시간이 없음.

라이다, 카메라 센서 필수
-> 둘다 필수?

관제 시스템 1개 이상 기능 구현

파라미터 수정이 가능해야 함

모든 통신은 ROS2

완벽한 구현까지는 아니어도 ㄱㅊㄱㅊ

시나리오는 무조건 가능성? or 아무거나


#### 조교 수업



### 검증 필요한 것들
- 무브잇2 사용 검증
- 터블봇이 플랫폼 위에 올라와 있고 그것이 올라갈 때 튕겨나가지 않는지 확인
- 맵 위에 다른 sdf 파일 올릴 수 있는지 검증.
	- 물리력이 있어도 충돌하는지 검증

- [x] 띄우기 검증하기 ✅ 2024-12-18
	- [x] 매니 터틀봇 띄우기 ✅ 2024-12-18
	- [ ] 다른 터틀봇도 띄우기
	- [ ] 그리퍼 손 짱 키우고 중앙 뻥튀기 시키지
	- [ ] 올라가는지 검증
- [ ] 매니퓰레이터 구동
	- [x] 매니퓰레이터 urdf 생성 ✅ 2024-12-20
	- [x] 무브잇 ✅ 2024-12-20
		- [x] 유데미 참고해서 로봇 새로 작성 ✅ 2024-12-19
			- [x] urdf 치수 gpt 물어보기 ✅ 2024-12-19
		- [x] 무브잇 연결, 파라미터 맞추기 ✅ 2024-12-19
		- [x] rviz2 시각화 ✅ 2024-12-19
		- [x] 도시에 띄우기 ✅ 2024-12-20
		- [x] 올라갈 때 빠르면 들어가는건지 물어보기 ✅ 2024-12-20
		- [x] grisp 쪽 알아보기, 추천받기 ✅ 2024-12-20
		- [x] grisp 적용 ✅ 2024-12-20
		- [ ] 홈으로 가는 경로 생성
		- [ ] 주차장으로 가는 경로 생성
			- [ ] 1
			- [ ] 2
			- [ ] 3
		- [ ] 주차 논리 만들기
		- [ ] 맵 합치기
		- [ ] 터틀봇 워크스에서 매니 실행
		- [ ] action 만들어서 구동
	- [ ] TF
		- [ ] 조인트 토픽 받으면 구동하는지 테스트
		- [ ] DH 풀기
		- [ ] TF 라이브러리 사용해서 연결
		- [ ] 조인트 이동
		- [ ] 마지막 조인트는 언제나 수평하게 명령
		- [ ] 보간해서 매끄럽게 만들기
	- [ ] open mani
		- [ ] 로봇 힘 늘리기
		- [ ] 분리하여 설치
		- [ ] 사이즈 키우기


###### 오픈 매니 실행 + car
ros2 launch turtlebot3_manipulation_moveit_config moveit_gazebo.launch.py

[[mani_urdf_12.19]]

### 내 예전 매니로 하기

![[Pasted image 20241219012125.png]]
![[Pasted image 20241219103252.png]]
![[Pasted image 20241219134013.png]]
ros2 launch turtlebot3_gazebo turtle_MANI_house.launch.py 
![[Pasted image 20241220134158.png]]
![[Pasted image 20241220165845.png]]
![[Pasted image 20241222002548.png]]
cd arduino_ws

ros2 launch arduinobot_controller controller.launch.py

ros2 launch arduinobot_description gazebo.launch.py 

###### 새 로봇 만드는 중
ros2 launch arduinobot_description display.launch.py model:=/home/theo/7_arduino_ws/src/Manipulator_study/arduinobot_description/urdf/arduinobot.urdf.xacro

###### 변화 적용하기
arduino_ws에 있는 xacro 전부 바꾸기
controller에 arduinobot_controllers.yaml 수정
gripper 관련된거 여러개 주석처리 controller.launch도 수정

cd 7_arduino_ws
ros2 launch arduinobot_description gazebo.launch.py 
ros2 launch arduinobot_controller controller.launch.py
ros2 launch arduinobot_moveit moveit.launch.py

ros2 launch arduinobot_description display.launch.py model:=/home/theo/7_arduino_ws/src/Manipulator_study/arduinobot_description/urdf/arduinobot.urdf.xacro

cd turtlebot3_ws
ros2 launch turtlebot3_gazebo turtle_MANI_house.launch.py 

**터틀봇 실행하고 있으면 무브잇 어디선가 충돌함 -> 어차피 실제로 할 때는 터틀봇이 다 namespace가 있음**

##### Grisp - 가제보에서 ROS2로(humble) 물체 붙이는(그립) 패키지
[GitHub - IFRA-Cranfield/IFRA\_LinkAttacher: This repository provides a simple ROS2 Gazebo plugin that creates a fixed joint between 2 different links in a Gazebo simulation.](https://github.com/IFRA-Cranfield/IFRA_LinkAttacher?tab=readme-ov-file)
여기 분들 사랑합니다

박스
ros2 service call /ATTACHLINK linkattacher_msgs/srv/AttachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'Big box', link2_name: 'Big box::link'}"

ros2 service call /DETACHLINK linkattacher_msgs/srv/DetachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'Big box', link2_name: 'Big box::link'}"

turtlebot3_waffle
ros2 service call /ATTACHLINK linkattacher_msgs/srv/AttachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'turtlebot3_waffle', link2_name: 'turtlebot3_waffle::base_link'}"

ros2 service call /DETACHLINK linkattacher_msgs/srv/DetachLink "{model1_name: 'arduinobot', link1_name: 'link_j6e', model2_name: 'turtlebot3_waffle', link2_name: 'turtlebot3_waffle::base_link'}"

### 이제 특정 곳을 액션으로 보낼 수도 있음

ros2 launch arduinobot_description gazebo.launch.py

ros2 launch arduinobot_controller controller.launch.py

ros2 launch arduinobot_moveit moveit.launch.py

ros2 launch arduinobot_remote remote_interface.launch.py

위에 있는 다 실행하면

아래 명령어들로 send goal로 지정된 위치로 보내기 가능.

ros2 action send_goal /task_server arduinobot_msgs/action/ArduinobotTask "task_number: 0"

ros2 action send_goal /task_server arduinobot_msgs/action/ArduinobotTask "task_number: 1"

90 미터 안쪽 반지름

###### 질문: 거대 매니 house에 올려서 시각화
I succeed to run this launch file.
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py
It shows a map in gazebo and spawn a turtlebot3. 
Here is the turtlebot3_house.launch.py:
```
#!/usr/bin/env python3

#

# Copyright 2019 ROBOTIS CO., LTD.

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

# http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

# Authors: Joep Tool

  

import os

  

from ament_index_python.packages import get_package_share_directory

from launch import LaunchDescription

from launch.actions import IncludeLaunchDescription

from launch.launch_description_sources import PythonLaunchDescriptionSource

from launch.substitutions import LaunchConfiguration

  
  

def generate_launch_description():

launch_file_dir = os.path.join(get_package_share_directory('turtlebot3_gazebo'), 'launch')

pkg_gazebo_ros = get_package_share_directory('gazebo_ros')

  

use_sim_time = LaunchConfiguration('use_sim_time', default='true')

x_pose = LaunchConfiguration('x_pose', default='-2.0')

y_pose = LaunchConfiguration('y_pose', default='-0.5')

z_pose = LaunchConfiguration('y_pose', default='1.0')

  

world = os.path.join(

get_package_share_directory('turtlebot3_gazebo'),

'worlds',

'turtlebot3_house.world'

)

  

gzserver_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzserver.launch.py')

),

launch_arguments={'world': world}.items()

)

  

gzclient_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzclient.launch.py')

)

)

  

robot_state_publisher_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'robot_state_publisher.launch.py')

),

launch_arguments={'use_sim_time': use_sim_time}.items()

)

  

spawn_turtlebot_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'spawn_turtlebot3.launch.py')

),

launch_arguments={

'x_pose': x_pose,

'y_pose': y_pose,

'z_pose': z_pose

}.items()

)

  

ld = LaunchDescription()

  

# Add the commands to the launch description

ld.add_action(gzserver_cmd)

ld.add_action(gzclient_cmd)

ld.add_action(robot_state_publisher_cmd)

ld.add_action(spawn_turtlebot_cmd)

  

return ld
```
Here is the current turtlebot3_house.world I used for that launch:
```
<?xml version="1.0"?>

<sdf version="1.5">

<world name="default">

<scene>

<grid>false</grid>

</scene>

<!-- A global light source -->

<include>

<uri>model://sun</uri>

<pose>1.5 -30 100 0 0 0</pose>

</include>

<!-- Stop signs -->

<include>

<name>stop_sign_0</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>3.5 -3.5 0 0 0 0</pose>

</include>

<include>

<name>stop_sign_1</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>-3 3 0 0 0 3.15</pose>

</include>

<!-- Houses -->

<include>

<name>house_1</name>

<uri>model://house_1</uri>

<pose>-12 12 0 0 0 0</pose>

</include>

<include>

<name>house_2</name>

<uri>model://house_2</uri>

<pose>-32 9 0 0 0 0</pose>

</include>

<include>

<name>house_3</name>

<uri>model://house_3</uri>

<pose>-5.5 -7 0 0 0 1.55</pose>

</include>

<!-- A gas station -->

<include>

<uri>model://gas_station</uri>

<pose>10 14 0 0 0 1.55</pose>

</include>

<!-- A fast food restaurant -->

<include>

<uri>model://fast_food</uri>

<pose>19.869 -13.2122 0 0 0 3.14159</pose>

</include>

<!-- Lamps -->

<include>

<name>lamp_post_0</name>

<uri>model://lamp_post</uri>

<pose>-3 13 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_1</name>

<uri>model://lamp_post</uri>

<pose>3 23 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_2</name>

<uri>model://lamp_post</uri>

<pose>-3 33 0 0 0 1.55</pose>

</include>

<include>sudo apt install ros-humble-gazebo-*
sudo apt install ros-humble-cartographer
sudo apt install ros-humble-cartographer-ros
sudo apt install ros-humble-navigation2
sudo apt install ros-humble-nav2-bringup
sudo apt install ros-humble-dynamixel-sdk
sudo apt install ros-humble-turtlebot3-msgs
sudo apt install ros-humble-turtlebot3

<name>lamp_post_3</name>

<uri>model://lamp_post</uri>

<pose>-3 -3 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_4</name>

<uri>model://lamp_post</uri>

<pose>3 -13 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_5</name>

<uri>model://lamp_post</uri>

<pose>-3 -23 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_6</name>

<uri>model://lamp_post</uri>

<pose>3 -33 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_7</name>

<uri>model://lamp_post</uri>

<pose>3 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_8</name>

<uri>model://lamp_post</uri>

<pose>13 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_9</name>

<uri>model://lamp_post</uri>

<pose>23 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_10</name>

<uri>model://lamp_post</uri>

<pose>33 -3 0 0 0 3.15</pose>

</include>

  

<include>

<name>lamp_post_11</name>

<uri>model://lamp_post</uri>

<pose>-13 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_12</name>

<uri>model://lamp_post</uri>

<pose>-23 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_13</name>

<uri>model://lamp_post</uri>

<pose>-33 3 0 0 0 0</pose>

</include>

  

<!-- Toyota Prius -->

<include>

<uri>model://prius_hybrid</uri>

<pose>1.5 -30 0 0 0 3.14</pose>

</include>

  

<!-- SUV -->

<include>

<uri>model://suv</uri>

<pose>23.453 13.121800 0 0 0 1.57</pose>

</include>

<!-- Roads -->

<include>

<uri>model://stopW</uri>

<pose>0 0 0 0 0 0</pose>

</include>

<!-- GUI -->

<gui fullscreen='0'>

<camera name='user_camera'>

<pose>

34.902946

-61.301678

25.866743

0.0

0.499643

2.016195

</pose>

</camera>

</gui>

  

</world>

</sdf>
```

But I'm trying to put a new thing. In that map. I want to put also a giant manipulator far from the middle. Like 100m away from it(x axis). 100m away might be above nothing. So the baselink should be fix on the air or with something else.
The giant manipulator is in another pkg:
theo@theo-2024:~/7_arduino_ws/src$ tree
.
└── Manipulator_study
    ├── arduinobot_controller
    │   ├── CMakeLists.txt
    │   ├── config
    │   │   └── arduinobot_controllers.yaml
    │   ├── launch
    │   │   └── controller.launch.py
    │   └── package.xml
    ├── arduinobot_cpp_example
    │   ├── CMakeLists.txt
    │   ├── package.xml
    │   └── src
    │       ├── simple_parameter.cpp
    │       ├── simple_publisher.cpp
    │       ├── simple_service_client.cpp
    │       ├── simple_service_server.cpp
    │       └── simple_subscriber.cpp
    ├── arduinobot_description
    │   ├── CMakeLists.txt
    │   ├── launch
    │   │   ├── display.launch.py
    │   │   └── gazebo.launch.py
    │   ├── meshes
    │   │   ├── basement.STL
    │   │   ├── base_plate.STL
    │   │   ├── claw_support.STL
    │   │   ├── forward_drive_arm.STL
    │   │   ├── horizontal_arm.STL
    │   │   ├── left_finger.STL
    │   │   ├── link.STL
    │   │   ├── pi_camera.STL
    │   │   ├── plate.STL
    │   │   ├── right_finger.STL
    │   │   ├── round_plate.STL
    │   │   ├── servo_plate.STL
    │   │   ├── triangular_link.STL
    │   │   └── vertical_drive_arm.STL
    │   ├── package.xml
    │   ├── rviz
    │   │   └── display.rviz
    │   └── urdf
    │       ├── arduinobot_gazebo.xacro
    │       ├── arduinobot_ros2_control.xacro
    │       ├── arduinobot.urdf copy.xacro
    │       └── arduinobot.urdf.xacro
    ├── arduinobot_moveit
    │   ├── CMakeLists.txt
    │   ├── config
    │   │   ├── arduinobot.srdf
    │   │   ├── initial_positions.yaml
    │   │   ├── joint_limits.yaml
    │   │   ├── kinematics.yaml
    │   │   ├── moveit_controllers.yaml
    │   │   ├── moveit.rviz
    │   │   ├── pilz_cartesian_limits.yaml
    │   │   └── planning_python_api.yaml
    │   ├── launch
    │   │   └── moveit.launch.py
    │   └── package.xml
    ├── arduinobot_msgs
    │   ├── action
    │   │   ├── ArduinobotTask.action
    │   │   └── Fibonacci.action
    │   ├── CMakeLists.txt
    │   ├── package.xml
    │   └── srv
    │       ├── AddTwoInts.srv
    │       ├── EulerToQuaternion.srv
    │       └── QuaternionToEuler.srv
    ├── arduinobot_py_example
    │   ├── arduinobot_py_example
    │   │   ├── __init__.py
    │   │   ├── simple_parameter.py
    │   │   ├── simple_publisher.py
    │   │   ├── simple_service_client.py
    │   │   ├── simple_service_server.py
    │   │   └── simple_subscriber.py
    │   ├── package.xml
    │   ├── resource
    │   │   └── arduinobot_py_example
    │   ├── setup.cfg
    │   ├── setup.py
    │   └── test
    │       ├── test_copyright.py
    │       ├── test_flake8.py
    │       └── test_pep257.py
    ├── arduinobot_remote
    │   ├── arduinobot_remote
    │   │   ├── alexa_interface.py
    │   │   ├── __init__.py
    │   │   └── task_server.py
    │   ├── CMakeLists.txt
    │   ├── launch
    │   │   └── remote_interface.launch.py
    │   ├── package.xml
    │   └── src
    │       └── task_server.cpp
    ├── build
    │   ├── arduinobot_py_example
    │   │   ├── arduinobot_py_example.egg-info
    │   │   │   ├── dependency_links.txt
    │   │   │   ├── entry_points.txt
    │   │   │   ├── PKG-INFO
    │   │   │   ├── requires.txt
    │   │   │   ├── SOURCES.txt
    │   │   │   ├── top_level.txt
    │   │   │   └── zip-safe
    │   │   ├── build
    │   │   │   └── lib
    │   │   │       └── arduinobot_py_example
    │   │   │           └── __init__.py
    │   │   ├── colcon_build.rc
    │   │   ├── colcon_command_prefix_setup_py.sh
    │   │   ├── colcon_command_prefix_setup_py.sh.env
    │   │   ├── install.log
    │   │   └── prefix_override
    │   │       ├── __pycache__
    │   │       │   └── sitecustomize.cpython-310.pyc
    │   │       └── sitecustomize.py
    │   └── COLCON_IGNORE
    ├── install
    │   ├── arduinobot_py_example
    │   │   ├── lib
    │   │   │   └── python3.10
    │   │   │       └── site-packages
    │   │   │           ├── arduinobot_py_example
    │   │   │           │   ├── __init__.py
    │   │   │           │   └── __pycache__
    │   │   │           │       └── __init__.cpython-310.pyc
    │   │   │           └── arduinobot_py_example-0.0.0-py3.10.egg-info
    │   │   │               ├── dependency_links.txt
    │   │   │               ├── entry_points.txt
    │   │   │               ├── PKG-INFO
    │   │   │               ├── requires.txt
    │   │   │               ├── SOURCES.txt
    │   │   │               ├── top_level.txt
    │   │   │               └── zip-safe
    │   │   └── share
    │   │       ├── ament_index
    │   │       │   └── resource_index
    │   │       │       └── packages
    │   │       │           └── arduinobot_py_example
    │   │       ├── arduinobot_py_example
    │   │       │   ├── hook
    │   │       │   │   ├── ament_prefix_path.dsv
    │   │       │   │   ├── ament_prefix_path.ps1
    │   │       │   │   ├── ament_prefix_path.sh
    │   │       │   │   ├── pythonpath.dsv
    │   │       │   │   ├── pythonpath.ps1
    │   │       │   │   └── pythonpath.sh
    │   │       │   ├── package.bash
    │   │       │   ├── package.dsv
    │   │       │   ├── package.ps1
    │   │       │   ├── package.sh
    │   │       │   ├── package.xml
    │   │       │   └── package.zsh
    │   │       └── colcon-core
    │   │           └── packages
    │   │               └── arduinobot_py_example
    │   ├── COLCON_IGNORE
    │   ├── local_setup.bash
    │   ├── local_setup.ps1
    │   ├── local_setup.sh
    │   ├── _local_setup_util_ps1.py
    │   ├── _local_setup_util_sh.py
    │   ├── local_setup.zsh
    │   ├── setup.bash
    │   ├── setup.ps1
    │   ├── setup.sh
    │   └── setup.zsh
    ├── log
    │   ├── build_2024-01-12_19-06-14
    │   │   ├── arduinobot_py_example
    │   │   │   ├── command.log
    │   │   │   ├── stderr.log
    │   │   │   ├── stdout.log
    │   │   │   ├── stdout_stderr.log
    │   │   │   └── streams.log
    │   │   ├── events.log
    │   │   └── logger_all.log
    │   └── COLCON_IGNORE
    └── README.md

52 directories, 130 files


Here how I normally launch the giant manipulator on a blank gazebo:
ros2 launch arduinobot_description gazebo.launch.py 

gazebo.launch.py :
```
import os

from ament_index_python.packages import get_package_share_directory, get_package_prefix

  

# 저번에 했던 것과 같이 런치 라이브러리, 지반번에 비해 몇개의 패키지가 추가됨

from launch import LaunchDescription

from launch.actions import DeclareLaunchArgument, IncludeLaunchDescription, SetEnvironmentVariable

from launch.substitutions import Command, LaunchConfiguration

from launch.launch_description_sources import PythonLaunchDescriptionSource

  

# 런치 로스 라이브러리

from launch_ros.actions import Node

from launch_ros.parameter_descriptions import ParameterValue

  

##### 기본적으로 가져와야하는 것은 같기 때문에 디스플레이 런치 파일에서 복붙

def generate_launch_description():

arduinobot_description_dir = get_package_share_directory('arduinobot_description')

# New os으로 디스크립션 share 경로 가져오고 변수에 저장

arduinobot_description_share = os.path.join(get_package_prefix('arduinobot_description'), 'share')

# New os으로 gazebo_ros를 가져와 저장

gazebo_ros_dir = get_package_share_directory('gazebo_ros')

  

model_arg = DeclareLaunchArgument(name='model', default_value=os.path.join(

arduinobot_description_dir, 'urdf', 'arduinobot.urdf.xacro'

),

description='Absolute path to robot urdf file'

)

  

# New 환경 설정

env_var = SetEnvironmentVariable('GAZEBO_MODEL_PATH', arduinobot_description_share)

  

robot_description = ParameterValue(Command(['xacro ', LaunchConfiguration('model')]),

value_type=str)

robot_state_publisher_node = Node(

package='robot_state_publisher',

executable='robot_state_publisher',

parameters=[{'robot_description': robot_description}]

)

  

# New 시뮬레이션 연산이 일어나는 곳

start_gazebo_server = IncludeLaunchDescription(

PythonLaunchDescriptionSource( # os로 시작 되는 위치 가져오기, 위에 저장된 경로 변수 넣고 런치 파일로 서버

os.path.join(gazebo_ros_dir, 'launch', 'gzserver.launch.py')

)

)

# New 시각화 인터페이스

start_gazebo_client = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(gazebo_ros_dir, 'launch', 'gzclient.launch.py')

)

)

# 여기까지만 하면 빈 공간은 생성 됨, 로봇을 환경에 소환하려면 아래 코드 작성

# New

spawn_robot = Node(package='gazebo_ros', executable='spawn_entity.py',

arguments=['-entity', 'arduinobot',

'-topic', 'robot_description',

],

output='screen'

)

  

return LaunchDescription([

env_var,

model_arg,

start_gazebo_server,

start_gazebo_client,

robot_state_publisher_node,

spawn_robot

])
```

Here is the xacro file of the manipulator:
```
<?xml version="1.0"?> <!--이건 xml 모델이라는 정의, 그리고 버전 정보도-->

  

<robot xmlns:xacro="http://www.ros.org/wiki.xacro" name="arduinobot"><!--XML 익스텐션으로 자동완성!! -->

<!-- xacro 연결, 로봇 이름 정의 -->

  

<!--옆에 파일 가져오기-->

<xacro:include filename="$(find arduinobot_description)/urdf/arduinobot_gazebo.xacro"/>

<xacro:include filename="$(find arduinobot_description)/urdf/arduinobot_ros2_control.xacro"/>

  

<!--inertial makro-->

<xacro:macro name="default_inertial" params="mass">

<inertial>

<mass value="${mass}"/>

<inertia ixx="10000" ixy="0.0" ixz="0.0"

iyy="10000" iyz="0.0"

izz="10000"/>

</inertial>

</xacro:macro>

  

<!--모터와 링크를 연결시키는 태그, number는 조인트 번호가 들어갈 예정-->

<xacro:macro name="default_transmission" params="number">

<transmission name="transmissiom_${number}">

<!--트랜스미션 라이브러리 플러그인-->

<plugin>transmission_interface/SimpleTransmission</plugin>

  

<!--엑추에이터와 조인트의 명과 역할 이름 붙이기-->

<actuator name="motor_${number}" role="actuactor1"/>

<joint name="joint_${number}" role="joint1">

<!--모터의 1도가 링크에서 1도임-->

<mechanical_reduction>1.0</mechanical_reduction>

</joint>

</transmission>

</xacro:macro>

  
  

<!-- 끝나기 전에 / 가 들어가 있으면 이는 한줄로 끝난다는겨 -->

<link name="world"/>

<!-- 위 링크는 이름만 있으면 됨, 모든 링크의 부모, 로봇이 월드에 붙어있게 도와줌 -->

  

<link name="base_link"> <!-- 베이스 링크 -->

<xacro:default_inertial mass="10000.0"/>

  

<visual> <!-- 시각적 -->

<!-- 오리진으로 위치와 방향, 각도rpy, 위치-->

<origin rpy="0 0 0" xyz="0 0 0"/> <!--좌표 수정-->

<geometry> <!-- 도형 -->

<!-- mesh 지정 -->

<box size="40 40 3"/> <!-- 그리고 스케일 지정, 아니면 너무 큼-->

</geometry>

</visual>

  

<!--가제보할 때 추가!-->

<!-- 기본적으로 비주얼과 같은 것을 가져옴-->

<collision>

<origin rpy="0 0 0" xyz="0 0 1"/> <!--좌표 수정-->

<geometry> <!-- 도형 -->

<!-- mesh 지정 -->

<box size="0 0 0"/> <!-- 그리고 스케일 지정, 아니면 너무 큼-->

</geometry>

</collision>

</link>

  

<joint name="virtual_joint" type="fixed"><!-- 월드랑 베이스 링크 연결, 종류는 고정-->

<parent link="world"/>

<child link="base_link"/>

<origin xyz="0 0 0" rpy="0 0 0"/>

</joint>

<!-- 위에 쓰고 CMake로-->

  
  
  

<!--여기부터 다음 단계 -->

  

<!-- xacro를 쓰는 이유, 변수 지정 가능. 지금은 PI라는 변수를 만든 것-->

<xacro:property name="PI" value= "3.14159"/>

<xacro:property name="effort" value= "30.0"/>

<xacro:property name="velocity" value= "10.0"/>

  

<!--베이스 플레이트 생성-->

<link name="base_plate">

<xacro:default_inertial mass="1000.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 7"/>

<geometry>

<box size="30 30 3"/> <!--이번에도 스케일을 똑같이 줄이자-->

</geometry>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 7"/>

<geometry>

<box size="30 30 3"/> <!--이번에도 스케일을 똑같이 줄이자-->

</geometry>

</collision>

</link>

  

<!--첫 움직이는 조인트! 그래서 type이 revolute-->

<joint name="joint_1" type="revolute">

<parent link="base_link"/>

<child link="base_plate"/>

<axis xyz="0 0 1"/><!-- z 축이 회전하는 것이다.-->

<origin rpy="0 0 0" xyz="0 0 0"/><!-- T matrix, 즉 z축으로 0.307 만큼 올라가는 뜻! -->

<!--조인트 움직임 한계 조절, effort는 토크 -->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

<!--xacro로 지정한 변수를 집어넣어서 유지보수를 쉽게!! ${변수}로 사용가능. 이때 연산은 안이든 밖이든 상관 없는 듯-->

<!-- 90 이동 제한이라 PI/2-->

</joint>

  
  
  

<!--그다음 강의-->

<!--urdf 치면 link 자동완성 양식이 나옴-->

<link name="link_j23">

<xacro:default_inertial mass="1000.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 15"/> <!-- 회전시켜 배치-->

<geometry>

<box size="10 10 20"/>

</geometry>

<material name="LightGrey">

<color rgba="0.7 0.7 0.7 1.0"/>

</material>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 15"/> <!-- 회전시켜 배치-->

<geometry>

<box size="10 10 20"/>

</geometry>

</collision>

</link>

  

<joint name="joint_2" type="revolute">

<parent link="base_plate"/>

<child link="link_j23"/>

<axis xyz="1 0 0"/><!-- x축 회전-->

<origin rpy="0 0 0" xyz="0 0 10"/><!--회전은 안하지만 평행이동은 했음-->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

</joint>

  

<link name="link_j34">

<xacro:default_inertial mass="1000.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 15"/> <!-- 회전시켜 배치-->

<geometry>

<box size="8 8 20"/>

</geometry>

<material name="LightGrey">

<color rgba="0.7 0.7 0.7 1.0"/>

</material>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 15"/> <!-- 회전시켜 배치-->

<geometry>

<box size="8 8 20"/>

</geometry>

</collision>

</link>

  

<joint name="joint_3" type="revolute">

<parent link="link_j23"/>

<child link="link_j34"/>

<axis xyz="1 0 0"/><!-- x축 회전-->

<origin rpy="0 0 0" xyz="0 0 40"/><!--회전은 안하지만 평행이동은 했음-->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

</joint>

  

<link name="link_j45">

<xacro:default_inertial mass="1000.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 10"/>

<geometry>

<box size="5 5 15"/>

</geometry>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 10"/>

<geometry>

<box size="5 5 15"/>

</geometry>

</collision>

</link>

  

<!-- <joint name="joint_4" type="fixed">

<parent link="link_j34"/>

<child link="link_j45"/>

<origin rpy="0 0 0" xyz="0 0 1.6"/>

</joint> -->

<joint name="joint_4" type="revolute">

<parent link="link_j34"/>

<child link="link_j45"/>

<axis xyz="1 0 0"/><!-- x축 회전-->

<origin rpy="0 0 0" xyz="0 0 30"/><!--회전은 안하지만 평행이동은 했음-->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

</joint>

  

<link name="link_j56">

<xacro:default_inertial mass="500.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 5"/>

<geometry>

<box size="3 3 7"/>

</geometry>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 5"/>

<geometry>

<box size="3 3 7"/>

</geometry>

</collision>

</link>

  

<joint name="joint_5" type="revolute">

<parent link="link_j45"/>

<child link="link_j56"/>

<axis xyz="1 0 0"/><!-- x축 회전-->

<origin rpy="0 0 0" xyz="0 0 20"/><!--회전은 안하지만 평행이동은 했음-->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

</joint>

  
  

<link name="link_j6e">

<xacro:default_inertial mass="500.0"/>

  

<visual>

<origin rpy="0 0 0" xyz="0 0 10"/>

<geometry>

<box size="10 1 10"/>

</geometry>

</visual>

  

<collision>

<origin rpy="0 0 0" xyz="0 0 10"/>

<geometry>

<box size="10 1 10"/>

</geometry>

</collision>

</link>

  

<joint name="joint_6" type="revolute">

<parent link="link_j56"/>

<child link="link_j6e"/>

<axis xyz="0 1 0"/><!-- y축 회전-->

<origin rpy="0 0 0" xyz="0 0 10"/><!--회전은 안하지만 평행이동은 했음-->

<limit lower="${-PI}" upper="${PI}" effort="${effort}" velocity="${velocity}"/>

</joint>

  
  
  

<!--트랜스미션 발동, 각 모터와 조인트 연결-->

<xacro:default_transmission number="1"/>

<xacro:default_transmission number="2"/>

<xacro:default_transmission number="3"/>

<xacro:default_transmission number="4"/>

<xacro:default_transmission number="5"/>

<xacro:default_transmission number="6"/>

  
  

</robot>
```







###### 질문: 오픈매니 맵에 나타내고 제어하기

I succeed to run this launch file.
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py
It shows a map in gazebo and spawn a turtlebot3. 
Here is the turtlebot3_house.launch.py:
```
#!/usr/bin/env python3

#

# Copyright 2019 ROBOTIS CO., LTD.

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

# http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

# Authors: Joep Tool

  

import os

  

from ament_index_python.packages import get_package_share_directory

from launch import LaunchDescription

from launch.actions import IncludeLaunchDescription

from launch.launch_description_sources import PythonLaunchDescriptionSource

from launch.substitutions import LaunchConfiguration

  
  

def generate_launch_description():

launch_file_dir = os.path.join(get_package_share_directory('turtlebot3_gazebo'), 'launch')

pkg_gazebo_ros = get_package_share_directory('gazebo_ros')

  

use_sim_time = LaunchConfiguration('use_sim_time', default='true')

x_pose = LaunchConfiguration('x_pose', default='-2.0')

y_pose = LaunchConfiguration('y_pose', default='-0.5')

z_pose = LaunchConfiguration('y_pose', default='1.0')

  

world = os.path.join(

get_package_share_directory('turtlebot3_gazebo'),

'worlds',

'turtlebot3_house.world'

)

  

gzserver_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzserver.launch.py')

),

launch_arguments={'world': world}.items()

)

  

gzclient_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzclient.launch.py')

)

)

  

robot_state_publisher_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'robot_state_publisher.launch.py')

),

launch_arguments={'use_sim_time': use_sim_time}.items()

)

  

spawn_turtlebot_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'spawn_turtlebot3.launch.py')

),

launch_arguments={

'x_pose': x_pose,

'y_pose': y_pose,

'z_pose': z_pose

}.items()

)

  

ld = LaunchDescription()

  

# Add the commands to the launch description

ld.add_action(gzserver_cmd)

ld.add_action(gzclient_cmd)

ld.add_action(robot_state_publisher_cmd)

ld.add_action(spawn_turtlebot_cmd)

  

return ld
```
Here is the current turtlebot3_house.world I used for that launch:
```
<?xml version="1.0"?>

<sdf version="1.5">

<world name="default">

<scene>

<grid>false</grid>

</scene>

<!-- A global light source -->

<include>

<uri>model://sun</uri>

<pose>1.5 -30 100 0 0 0</pose>

</include>

<!-- Stop signs -->

<include>

<name>stop_sign_0</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>3.5 -3.5 0 0 0 0</pose>

</include>

<include>

<name>stop_sign_1</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>-3 3 0 0 0 3.15</pose>

</include>

<!-- Houses -->

<include>

<name>house_1</name>

<uri>model://house_1</uri>

<pose>-12 12 0 0 0 0</pose>

</include>

<include>

<name>house_2</name>

<uri>model://house_2</uri>

<pose>-32 9 0 0 0 0</pose>

</include>

<include>

<name>house_3</name>

<uri>model://house_3</uri>

<pose>-5.5 -7 0 0 0 1.55</pose>

</include>

<!-- A gas station -->

<include>

<uri>model://gas_station</uri>

<pose>10 14 0 0 0 1.55</pose>

</include>

<!-- A fast food restaurant -->

<include>

<uri>model://fast_food</uri>

<pose>19.869 -13.2122 0 0 0 3.14159</pose>

</include>

<!-- Lamps -->

<include>

<name>lamp_post_0</name>

<uri>model://lamp_post</uri>

<pose>-3 13 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_1</name>

<uri>model://lamp_post</uri>

<pose>3 23 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_2</name>

<uri>model://lamp_post</uri>

<pose>-3 33 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_3</name>

<uri>model://lamp_post</uri>

<pose>-3 -3 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_4</name>

<uri>model://lamp_post</uri>

<pose>3 -13 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_5</name>

<uri>model://lamp_post</uri>

<pose>-3 -23 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_6</name>

<uri>model://lamp_post</uri>

<pose>3 -33 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_7</name>

<uri>model://lamp_post</uri>

<pose>3 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_8</name>

<uri>model://lamp_post</uri>

<pose>13 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_9</name>

<uri>model://lamp_post</uri>

<pose>23 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_10</name>

<uri>model://lamp_post</uri>

<pose>33 -3 0 0 0 3.15</pose>

</include>

  

<include>

<name>lamp_post_11</name>

<uri>model://lamp_post</uri>

<pose>-13 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_12</name>

<uri>model://lamp_post</uri>

<pose>-23 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_13</name>

<uri>model://lamp_post</uri>

<pose>-33 3 0 0 0 0</pose>

</include>

  

<!-- Toyota Prius -->

<include>

<uri>model://prius_hybrid</uri>

<pose>1.5 -30 0 0 0 3.14</pose>

</include>

  

<!-- SUV -->

<include>

<uri>model://suv</uri>

<pose>23.453 13.121800 0 0 0 1.57</pose>

</include>

<!-- Roads -->

<include>

<uri>model://stopW</uri>

<pose>0 0 0 0 0 0</pose>

</include>

<!-- GUI -->

<gui fullscreen='0'>

<camera name='user_camera'>

<pose>

34.902946

-61.301678

25.866743

0.0

0.499643

2.016195

</pose>

</camera>

</gui>

  

</world>

</sdf>
```

But I'm trying to put a new thing. In that map. I want to put also the turtlebot3 open manipulator.
I'm currently succeed to move the manipulator on gazebo with an interface on rviz2 with this launch:
ros2 launch turtlebot3_manipulation_moveit_config moveit_gazebo.launch.py
Which is in this pkg:
theo@theo-2024:~/turtlebot3_ws/src/turtlebot3_manipulation$ tree
.
├── CONTRIBUTING.md
├── LICENSE
├── README.md
├── turtlebot3_manipulation
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   └── package.xml
├── turtlebot3_manipulation_bringup
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── config
│   │   ├── gazebo_controller_manager.yaml
│   │   └── hardware_controller_manager.yaml
│   ├── env-hooks
│   │   └── turtlebot3_manipulation_bringup.dsv.in
│   ├── launch
│   │   ├── base.launch.py
│   │   ├── fake.launch.py
│   │   ├── gazebo.launch.py
│   │   └── hardware.launch.py
│   ├── package.xml
│   ├── rviz
│   │   └── turtlebot3_manipulation.rviz
│   └── worlds
│       ├── empty_world.model
│       ├── turtlebot3_world
│       │   ├── meshes
│       │   │   ├── hexagon.dae
│       │   │   └── wall.dae
│       │   ├── model-1_4.sdf
│       │   ├── model.config
│       │   └── model.sdf
│       └── turtlebot3_world.model
├── turtlebot3_manipulation_cartographer
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── config
│   │   └── turtlebot3_2d.lua
│   ├── launch
│   │   └── cartographer.launch.py
│   ├── package.xml
│   └── rviz
│       └── cartographer.rviz
├── turtlebot3_manipulation_description
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── env-hooks
│   │   └── turtlebot3_manipulation_description.dsv.in
│   ├── gazebo
│   │   ├── materials.xacro
│   │   ├── open_manipulator_x.gazebo.xacro
│   │   └── turtlebot3_waffle_pi.gazebo.xacro
│   ├── launch
│   │   └── model.launch.py
│   ├── meshes
│   │   ├── open_manipulator_x
│   │   │   ├── gripper_left_palm.stl
│   │   │   ├── gripper_right_palm.stl
│   │   │   ├── link1.stl
│   │   │   ├── link2.stl
│   │   │   ├── link3.stl
│   │   │   ├── link4.stl
│   │   │   └── link5.stl
│   │   └── turtlebot3_waffle_pi
│   │       ├── base.stl
│   │       ├── ladar.stl
│   │       ├── left_tire.stl
│   │       └── right_tire.stl
│   ├── package.xml
│   ├── ros2_control
│   │   └── turtlebot3_manipulation_system.ros2_control.xacro
│   ├── rviz
│   │   └── model.rviz
│   └── urdf
│       ├── open_manipulator_x.urdf.xacro
│       ├── turtlebot3_manipulation.urdf.xacro
│       └── turtlebot3_waffle_pi.urdf.xacro
├── turtlebot3_manipulation_hardware
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── include
│   │   └── turtlebot3_manipulation_hardware
│   │       ├── dynamixel_sdk_wrapper.hpp
│   │       ├── opencr_control_table.hpp
│   │       ├── opencr_definitions.hpp
│   │       ├── opencr.hpp
│   │       ├── turtlebot3_manipulation_system.hpp
│   │       └── visibility_control.h
│   ├── package.xml
│   ├── src
│   │   ├── dynamixel_sdk_wrapper.cpp
│   │   ├── opencr.cpp
│   │   └── turtlebot3_manipulation_system.cpp
│   └── turtlebot3_manipulation_hardware.xml
├── turtlebot3_manipulation_moveit_config
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── config
│   │   ├── initial_positions.yaml
│   │   ├── joint_limits.yaml
│   │   ├── kinematics.yaml
│   │   ├── moveit_controllers.yaml
│   │   ├── moveit.rviz
│   │   ├── moveit_servo.yaml
│   │   ├── moveit_teleop.rviz
│   │   ├── ompl_planning.yaml
│   │   └── turtlebot3_manipulation.srdf
│   ├── launch
│   │   ├── move_group.launch.py
│   │   ├── moveit_core.launch.py
│   │   ├── moveit_fake.launch.py
│   │   ├── moveit_gazebo.launch.py
│   │   ├── moveit_rviz.launch.py
│   │   ├── rsp.launch.py
│   │   ├── servo.launch.py
│   │   ├── setup_assistant.launch.py
│   │   ├── spawn_controllers.launch.py
│   │   ├── static_virtual_joint_tfs.launch.py
│   │   └── warehouse_db.launch.py
│   └── package.xml
├── turtlebot3_manipulation_navigation2
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── launch
│   │   ├── navigation2.launch.py
│   │   └── navigation2_use_sim_time.launch.py
│   ├── map
│   │   ├── turtlebot3_world.pgm
│   │   └── turtlebot3_world.yaml
│   ├── package.xml
│   ├── param
│   │   ├── turtlebot3_use_sim_time.yaml
│   │   └── turtlebot3.yaml
│   └── rviz
│       └── navigation2.rviz
└── turtlebot3_manipulation_teleop
    ├── CHANGELOG.rst
    ├── CMakeLists.txt
    ├── include
    │   └── turtlebot3_manipulation_teleop
    │       └── turtlebot3_manipulation_teleop.hpp
    ├── package.xml
    └── src
        └── turtlebot3_manipulation_teleop.cpp

39 directories, 105 files

So, in the turtlebot3 house map on gazebo. I want to add the manipulator that actually works. I should be able to control the manipulator as the same way I control it on rviz2.
The manipulator should be placed 10m(x axis) away from the middle. Turtlebot3 should also running normaly.
Inform me if you need addional info. I'm not really familiar so I don't know much.




###### 질문: 매니퓰레이터를 맵에 나타나게하기!

I succeed to run this launch file.
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py
It shows a map in gazebo and spawn a turtlebot3. 
Here is the turtlebot3_house.launch.py:
```
#!/usr/bin/env python3

#

# Copyright 2019 ROBOTIS CO., LTD.

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

# http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

# Authors: Joep Tool

  

import os

  

from ament_index_python.packages import get_package_share_directory

from launch import LaunchDescription

from launch.actions import IncludeLaunchDescription

from launch.launch_description_sources import PythonLaunchDescriptionSource

from launch.substitutions import LaunchConfiguration

  
  

def generate_launch_description():

launch_file_dir = os.path.join(get_package_share_directory('turtlebot3_gazebo'), 'launch')

pkg_gazebo_ros = get_package_share_directory('gazebo_ros')

  

use_sim_time = LaunchConfiguration('use_sim_time', default='true')

x_pose = LaunchConfiguration('x_pose', default='-2.0')

y_pose = LaunchConfiguration('y_pose', default='-0.5')

z_pose = LaunchConfiguration('y_pose', default='1.0')

  

world = os.path.join(

get_package_share_directory('turtlebot3_gazebo'),

'worlds',

'turtlebot3_house.world'

)

  

gzserver_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzserver.launch.py')

),

launch_arguments={'world': world}.items()

)

  

gzclient_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzclient.launch.py')

)

)

  

robot_state_publisher_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'robot_state_publisher.launch.py')

),

launch_arguments={'use_sim_time': use_sim_time}.items()

)

  

spawn_turtlebot_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'spawn_turtlebot3.launch.py')

),

launch_arguments={

'x_pose': x_pose,

'y_pose': y_pose,

'z_pose': z_pose

}.items()

)

  

ld = LaunchDescription()

  

# Add the commands to the launch description

ld.add_action(gzserver_cmd)

ld.add_action(gzclient_cmd)

ld.add_action(robot_state_publisher_cmd)

ld.add_action(spawn_turtlebot_cmd)

  

return ld
```
Here is the current turtlebot3_house.world I used for that launch:
```
<?xml version="1.0"?>

<sdf version="1.5">

<world name="default">

<scene>

<grid>false</grid>

</scene>

<!-- A global light source -->

<include>

<uri>model://sun</uri>

<pose>1.5 -30 100 0 0 0</pose>

</include>

<!-- Stop signs -->

<include>

<name>stop_sign_0</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>3.5 -3.5 0 0 0 0</pose>

</include>

<include>

<name>stop_sign_1</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>-3 3 0 0 0 3.15</pose>

</include>

<!-- Houses -->

<include>

<name>house_1</name>

<uri>model://house_1</uri>

<pose>-12 12 0 0 0 0</pose>

</include>

<include>

<name>house_2</name>

<uri>model://house_2</uri>

<pose>-32 9 0 0 0 0</pose>

</include>

<include>

<name>house_3</name>

<uri>model://house_3</uri>

<pose>-5.5 -7 0 0 0 1.55</pose>

</include>

<!-- A gas station -->

<include>

<uri>model://gas_station</uri>

<pose>10 14 0 0 0 1.55</pose>

</include>

<!-- A fast food restaurant -->

<include>

<uri>model://fast_food</uri>

<pose>19.869 -13.2122 0 0 0 3.14159</pose>

</include>

<!-- Lamps -->

<include>

<name>lamp_post_0</name>

<uri>model://lamp_post</uri>

<pose>-3 13 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_1</name>

<uri>model://lamp_post</uri>

<pose>3 23 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_2</name>

<uri>model://lamp_post</uri>

<pose>-3 33 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_3</name>

<uri>model://lamp_post</uri>

<pose>-3 -3 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_4</name>

<uri>model://lamp_post</uri>

<pose>3 -13 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_5</name>

<uri>model://lamp_post</uri>

<pose>-3 -23 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_6</name>

<uri>model://lamp_post</uri>

<pose>3 -33 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_7</name>

<uri>model://lamp_post</uri>

<pose>3 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_8</name>

<uri>model://lamp_post</uri>

<pose>13 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_9</name>

<uri>model://lamp_post</uri>

<pose>23 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_10</name>

<uri>model://lamp_post</uri>

<pose>33 -3 0 0 0 3.15</pose>

</include>

  

<include>

<name>lamp_post_11</name>

<uri>model://lamp_post</uri>

<pose>-13 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_12</name>

<uri>model://lamp_post</uri>

<pose>-23 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_13</name>

<uri>model://lamp_post</uri>

<pose>-33 3 0 0 0 0</pose>

</include>

  

<!-- Toyota Prius -->

<include>

<uri>model://prius_hybrid</uri>

<pose>1.5 -30 0 0 0 3.14</pose>

</include>

  

<!-- SUV -->

<include>

<uri>model://suv</uri>

<pose>23.453 13.121800 0 0 0 1.57</pose>

</include>

<!-- Roads -->

<include>

<uri>model://stopW</uri>

<pose>0 0 0 0 0 0</pose>

</include>

<!-- GUI -->

<gui fullscreen='0'>

<camera name='user_camera'>

<pose>

34.902946

-61.301678

25.866743

0.0

0.499643

2.016195

</pose>

</camera>

</gui>

  

</world>

</sdf>
```

But I'm trying to put a new thing. In that map. I want to put a custom manipulator.
I'm currently succeed to move my example manipulator in another pkg with rviz2.
This is the tree of that manipulator pkg:
theo@theo-2024:~/ws_urdf/src/testbot_description$ tree
.
├── launch
│   └── testbot.launch.py
├── package.xml
├── resource
│   └── testbot_description
├── rviz
├── setup.cfg
├── setup.py
├── test
│   ├── test_copyright.py
│   ├── test_flake8.py
│   └── test_pep257.py
├── testbot_description
│   └── __init__.py
└── urdf
    └── testbot.urdf

6 directories, 10 files

I used this launch file for run the manipulator on rviz2.
ros2 launch testbot_description testbot.launch.py
Here is the testbot.launch.py:
```
import os
from ament_index_python.packages import get_package_share_directory
from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    # Paths to configuration and URDF files
    rviz_display_config_file = os.path.join(
        get_package_share_directory('testbot_description'),
        'rviz',
        'testbot.rviz'
    )

    urdf_file = os.path.join(
        get_package_share_directory('testbot_description'),
        'urdf',
        'testbot.urdf'
    )

    # Read the URDF file
    with open(urdf_file, "r") as infp:
        robot_description_file = infp.read()

    # Create the LaunchDescription object
    ld = LaunchDescription()

    # Robot State Publisher Node
    robot_state_publisher = Node(
        package='robot_state_publisher',
        executable='robot_state_publisher',
        parameters=[
            {'use_sim_time': False},
            {'robot_description': robot_description_file}
        ],
        output='screen'
    )

    # Joint State Publisher GUI Node
    joint_state_publisher_gui = Node(
        package='joint_state_publisher_gui',
        executable='joint_state_publisher_gui',
        output='screen'
    )

    # RViz2 Node
    rviz2 = Node(
        package='rviz2',
        executable='rviz2',
        arguments=['-d', rviz_display_config_file],
        output='screen'
    )

    # Add nodes to the LaunchDescription
    ld.add_action(robot_state_publisher)
    ld.add_action(joint_state_publisher_gui)
    ld.add_action(rviz2)

    return ld
```
Here is the testbot.urdf:
```
<?xml version="1.0"?>
<robot name="testbot">
  <!-- Materials -->
  <material name="green">
    <color rgba="0 0.6 0 1"/>
  </material>
  <material name="orange">
    <color rgba="1.0 0.4 0.0 1.0"/>
  </material>
  <!-- Links -->
  <link name="base"/>
  <link name="link1">
    <inertial>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <mass value="1.0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <visual>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
    </collision>
  </link>
  <link name="link2">
    <inertial>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <mass value="1.0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <visual>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
      <material name="orange"/>
    </visual>
    <collision>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
    </collision>
  </link>
  <link name="link3">
    <inertial>
      <origin xyz="0.0 0.0 0.5" rpy="0.0 0.0 0.0"/>
      <mass value="1.0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <visual>
      <origin xyz="0.0 0.0 0.5" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 1.0"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <origin xyz="0.0 0.0 0.5" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 1.0"/>
      </geometry>
    </collision>
  </link>
  <link name="link4">
    <inertial>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <mass value="1.0"/>
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
    </inertial>
    <visual>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
      <material name="orange"/>
    </visual>
    <collision>
      <origin xyz="0.0 0.0 0.25" rpy="0.0 0.0 0.0"/>
      <geometry>
        <box size="0.1 0.1 0.5"/>
      </geometry>
    </collision>
  </link>
  <!-- Joints -->
  <joint name="base_joint" type="fixed">
    <parent link="base"/>
    <child link="link1"/>
  </joint>
  <joint name="link1_link2" type="revolute">
    <origin xyz="0.0 0.0 0.5" rpy="0.0 0.0 0.0"/>
    <parent link="link1"/>
    <child link="link2"/>
    <axis xyz="0.0 0.0 1.0"/>
    <limit lower="-2.617" upper="2.617" effort="30.0" velocity="1.571"/>
  </joint>
  <joint name="link2_link3" type="revolute">
    <origin xyz="0.0 0.0 0.5" rpy="0.0 0.0 0.0"/>
    <parent link="link2"/>
    <child link="link3"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit lower="-2.617" upper="2.617" effort="30.0" velocity="1.571"/>
  </joint>
  <joint name="link3_link4" type="revolute">
    <origin xyz="0.0 0.0 1.0" rpy="0.0 0.0 0.0"/>
    <parent link="link3"/>
    <child link="link4"/>
    <axis xyz="0.0 1.0 0.0"/>
    <limit lower="-2.617" upper="2.617" effort="30.0" velocity="1.571"/>
  </joint>
</robot>
```

So, in the turtlebot3 used house map on gazebo. I want to add custom manipulator that actually works. I should be able to control the manipulator as the same way I control it on rviz2.
The manipulator should be placed 10m(x axis) away from the middle. Turtlebot3 should also running normaly.
Inform me if you need addional info. I'm not really familiar so I don't know much.

|     |     |
| --- | --- |
|     |     |


#### 질문:

In Ubuntu 22.04 ROS2 humble. I'm using turtlebot3 on gazebo.
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py
This launch cli open tha gazebo and show the world map with the robot. It works pretty well.
Here is the tree of the the my turtlebot3 sim:
theo@theo-2024:~/turtlebot3_ws/src/turtlebot3_simulations$ tree
.
├── CONTRIBUTING.md
├── LICENSE
├── README.md
├── turtlebot3_fake_node
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── include
│   │   └── turtlebot3_fake_node
│   │       └── turtlebot3_fake_node.hpp
│   ├── launch
│   │   ├── rviz2.launch.py
│   │   └── turtlebot3_fake_node.launch.py
│   ├── package.xml
│   ├── param
│   │   ├── burger.yaml
│   │   ├── waffle_pi.yaml
│   │   └── waffle.yaml
│   └── src
│       └── turtlebot3_fake_node.cpp
├── turtlebot3_gazebo
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   ├── include
│   │   └── turtlebot3_gazebo
│   │       └── turtlebot3_drive.hpp
│   ├── launch
│   │   ├── empty_world.launch.py
│   │   ├── robot_state_publisher.launch.py
│   │   ├── spawn_turtlebot3.launch.py
│   │   ├── turtlebot3_dqn_stage1.launch.py
│   │   ├── turtlebot3_dqn_stage2.launch.py
│   │   ├── turtlebot3_dqn_stage3.launch.py
│   │   ├── turtlebot3_dqn_stage4.launch.py
│   │   ├── turtlebot3_house.launch.py
│   │   └── turtlebot3_world.launch.py
│   ├── models
│   │   ├── turtlebot3_burger
│   │   │   ├── model-1_4.sdf
│   │   │   ├── model.config
│   │   │   └── model.sdf
│   │   ├── turtlebot3_common
│   │   │   ├── meshes
│   │   │   │   ├── burger_base.dae
│   │   │   │   ├── lds.dae
│   │   │   │   ├── r200.dae
│   │   │   │   ├── tire.dae
│   │   │   │   ├── waffle_base.dae
│   │   │   │   └── waffle_pi_base.dae
│   │   │   └── model.config
│   │   ├── turtlebot3_dqn_world
│   │   │   ├── goal_box
│   │   │   │   ├── model.config
│   │   │   │   └── model.sdf
│   │   │   ├── inner_walls
│   │   │   │   ├── model.config
│   │   │   │   └── model.sdf
│   │   │   ├── model.config
│   │   │   ├── model.sdf
│   │   │   ├── obstacle1
│   │   │   │   ├── model.config
│   │   │   │   └── model.sdf
│   │   │   ├── obstacle2
│   │   │   │   ├── model.config
│   │   │   │   └── model.sdf
│   │   │   ├── obstacle_plugin
│   │   │   │   ├── CMakeLists.txt
│   │   │   │   ├── obstacle1.cc
│   │   │   │   ├── obstacle2.cc
│   │   │   │   └── obstacles.cc
│   │   │   └── obstacles
│   │   │       ├── model.config
│   │   │       └── model.sdf
│   │   ├── turtlebot3_house
│   │   │   ├── model.config
│   │   │   └── model.sdf
│   │   ├── turtlebot3_waffle
│   │   │   ├── model-1_4.sdf
│   │   │   ├── model.config
│   │   │   └── model.sdf
│   │   ├── turtlebot3_waffle_pi
│   │   │   ├── model-1_4_.sdf
│   │   │   ├── model.config
│   │   │   └── model.sdf
│   │   └── turtlebot3_world
│   │       ├── meshes
│   │       │   ├── hexagon.dae
│   │       │   └── wall.dae
│   │       ├── model-1_4.sdf
│   │       ├── model.config
│   │       └── model.sdf
│   ├── package.xml
│   ├── rviz
│   │   └── tb3_gazebo.rviz
│   ├── src
│   │   └── turtlebot3_drive.cpp
│   ├── urdf
│   │   ├── common_properties.urdf
│   │   ├── turtlebot3_burger.urdf
│   │   ├── turtlebot3_waffle_pi.urdf
│   │   └── turtlebot3_waffle.urdf
│   └── worlds
│       ├── empty_world.world
│       ├── turtlebot3_dqn_stage1.world
│       ├── turtlebot3_dqn_stage2.world
│       ├── turtlebot3_dqn_stage3.world
│       ├── turtlebot3_dqn_stage4.world
│       ├── turtlebot3_house.world
│       └── turtlebot3_world.world
├── turtlebot3_simulations
│   ├── CHANGELOG.rst
│   ├── CMakeLists.txt
│   └── package.xml
└── turtlebot3_simulations_ci.repos

31 directories, 82 files

Here is the turtlebot3_house.launch.py file code:
```
#!/usr/bin/env python3

#

# Copyright 2019 ROBOTIS CO., LTD.

#

# Licensed under the Apache License, Version 2.0 (the "License");

# you may not use this file except in compliance with the License.

# You may obtain a copy of the License at

#

# http://www.apache.org/licenses/LICENSE-2.0

#

# Unless required by applicable law or agreed to in writing, software

# distributed under the License is distributed on an "AS IS" BASIS,

# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and

# limitations under the License.

#

# Authors: Joep Tool

  

import os

  

from ament_index_python.packages import get_package_share_directory

from launch import LaunchDescription

from launch.actions import IncludeLaunchDescription

from launch.launch_description_sources import PythonLaunchDescriptionSource

from launch.substitutions import LaunchConfiguration

  
  

def generate_launch_description():

launch_file_dir = os.path.join(get_package_share_directory('turtlebot3_gazebo'), 'launch')

pkg_gazebo_ros = get_package_share_directory('gazebo_ros')

  

use_sim_time = LaunchConfiguration('use_sim_time', default='true')

x_pose = LaunchConfiguration('x_pose', default='-2.0')

y_pose = LaunchConfiguration('y_pose', default='-0.5')

z_pose = LaunchConfiguration('y_pose', default='1.0')

  

world = os.path.join(

get_package_share_directory('turtlebot3_gazebo'),

'worlds',

'turtlebot3_house.world'

)

  

gzserver_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzserver.launch.py')

),

launch_arguments={'world': world}.items()

)

  

gzclient_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(pkg_gazebo_ros, 'launch', 'gzclient.launch.py')

)

)

  

robot_state_publisher_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'robot_state_publisher.launch.py')

),

launch_arguments={'use_sim_time': use_sim_time}.items()

)

  

spawn_turtlebot_cmd = IncludeLaunchDescription(

PythonLaunchDescriptionSource(

os.path.join(launch_file_dir, 'spawn_turtlebot3.launch.py')

),

launch_arguments={

'x_pose': x_pose,

'y_pose': y_pose,

'z_pose': z_pose

}.items()

)

  

ld = LaunchDescription()

  

# Add the commands to the launch description

ld.add_action(gzserver_cmd)

ld.add_action(gzclient_cmd)

ld.add_action(robot_state_publisher_cmd)

ld.add_action(spawn_turtlebot_cmd)

  

return ld
```
Here is the turtlebot3_house.world code:
```
<?xml version="1.0"?>

<sdf version="1.6">

<world name="default">

  

<include>

<uri>model://ground_plane</uri>

</include>

  

<include>

<uri>model://sun</uri>

</include>

  

<scene>

<shadows>false</shadows>

</scene>

  

<gui fullscreen='0'>

<camera name='user_camera'>

<pose frame=''>0.319654 -0.235002 9.29441 0 1.5138 0.009599</pose>

<view_controller>orbit</view_controller>

<projection_type>perspective</projection_type>

</camera>

</gui>

  

<physics type="ode">

<real_time_update_rate>1000.0</real_time_update_rate>

<max_step_size>0.001</max_step_size>

<real_time_factor>1</real_time_factor>

<ode>

<solver>

<type>quick</type>

<iters>150</iters>

<precon_iters>0</precon_iters>

<sor>1.400000</sor>

<use_dynamic_moi_rescaling>1</use_dynamic_moi_rescaling>

</solver>

<constraints>

<cfm>0.00001</cfm>

<erp>0.2</erp>

<contact_max_correcting_vel>2000.000000</contact_max_correcting_vel>

<contact_surface_layer>0.01000</contact_surface_layer>

</constraints>

</ode>

</physics>

  

<model name="turtlebot3_house">

<static>1</static>

<include>

<uri>model://turtlebot3_house</uri>

</include>

</model>

  

</world>

</sdf>
```

But I want to change the map. I want to make a new launch file which similarly open gazebo and spawn the robot but in another map.
The new map is named 'car' or 'car.world'.
But I don't know how to.

I know the car.world code:
```
<?xml version="1.0"?>

<sdf version="1.5">

<world name="default">

<scene>

<grid>false</grid>

</scene>

<!-- A global light source -->

<include>

<uri>model://sun</uri>

<pose>1.5 -30 100 0 0 0</pose>

</include>

<!-- Stop signs -->

<include>

<name>stop_sign_0</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>3.5 -3.5 0 0 0 0</pose>

</include>

<include>

<name>stop_sign_1</name>

<static>true</static>

<uri>model://stop_sign</uri>

<pose>-3 3 0 0 0 3.15</pose>

</include>

<!-- Houses -->

<include>

<name>house_1</name>

<uri>model://house_1</uri>

<pose>-12 12 0 0 0 0</pose>

</include>

<include>

<name>house_2</name>

<uri>model://house_2</uri>

<pose>-32 9 0 0 0 0</pose>

</include>

<include>

<name>house_3</name>

<uri>model://house_3</uri>

<pose>-5.5 -7 0 0 0 1.55</pose>

</include>

<!-- A gas station -->

<include>

<uri>model://gas_station</uri>

<pose>10 14 0 0 0 1.55</pose>

</include>

<!-- A fast food restaurant -->

<include>

<uri>model://fast_food</uri>

<pose>19.869 -13.2122 0 0 0 3.14159</pose>

</include>

<!-- Lamps -->

<include>

<name>lamp_post_0</name>

<uri>model://lamp_post</uri>

<pose>-3 13 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_1</name>

<uri>model://lamp_post</uri>

<pose>3 23 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_2</name>

<uri>model://lamp_post</uri>

<pose>-3 33 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_3</name>

<uri>model://lamp_post</uri>

<pose>-3 -3 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_4</name>

<uri>model://lamp_post</uri>

<pose>3 -13 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_5</name>

<uri>model://lamp_post</uri>

<pose>-3 -23 0 0 0 1.55</pose>

</include>

<include>

<name>lamp_post_6</name>

<uri>model://lamp_post</uri>

<pose>3 -33 0 0 0 -1.55</pose>

</include>

<include>

<name>lamp_post_7</name>

<uri>model://lamp_post</uri>

<pose>3 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_8</name>

<uri>model://lamp_post</uri>

<pose>13 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_9</name>

<uri>model://lamp_post</uri>

<pose>23 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_10</name>

<uri>model://lamp_post</uri>

<pose>33 -3 0 0 0 3.15</pose>

</include>

  

<include>

<name>lamp_post_11</name>

<uri>model://lamp_post</uri>

<pose>-13 3 0 0 0 0</pose>

</include>

<include>

<name>lamp_post_12</name>

<uri>model://lamp_post</uri>

<pose>-23 -3 0 0 0 3.15</pose>

</include>

<include>

<name>lamp_post_13</name>

<uri>model://lamp_post</uri>

<pose>-33 3 0 0 0 0</pose>

</include>

  

<!-- Toyota Prius -->

<include>

<uri>model://prius_hybrid</uri>

<pose>1.5 -30 0 0 0 3.14</pose>

</include>

  

<!-- SUV -->

<include>

<uri>model://suv</uri>

<pose>23.453 13.121800 0 0 0 1.57</pose>

</include>

<!-- Roads -->

<include>

<uri>model://stopW</uri>

<pose>0 0 0 0 0 0</pose>

</include>

<!-- GUI -->

<gui fullscreen='0'>

<camera name='user_camera'>

<pose>

34.902946

-61.301678

25.866743

0.0

0.499643

2.016195

</pose>

</camera>

</gui>

</world>

</sdf>
```
That code is in the worlds folder here:
theo@theo-2024:~/worlds/src$ ls
build           maps         rviz
CMakeLists.txt  media        scripts
config          meshes       urdf
install         models       worlds
launch          package.xml
log             params

So, how should I make the launch file and launch the gazebo with new map. If there is additonal file path, or file to considerm inform me. I'm not really familiar with gazebo so I don't know what we need to show a map in gazebo.



-다




