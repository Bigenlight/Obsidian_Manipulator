---
Title: Python 17강-이터&제네리터, 코루틴
tags: 
NeedCheck: 복습 필요
Review: 
비고: 처음 배움
---
[[Python 이론]]
![[Python-17 1.pdf]]

## 이터레이터
Iterator, '반복자'라도고 부름
![[Pasted image 20240730161341.png]]

쓸 곳이 없고 불편해 보이지만, 머신 러닝 데이터 로더에서 필요하다고 함.

반복 가능한 객체에 사용 가능
![[Pasted image 20240730162739.png|300]]
리스트, 문자열, 튜플, 세트, 딕셔너리, range() 등
==반복 가능한 객체==에 iter()를 사용하면 ==이터레이터==가 됨.
![[Pasted image 20240730162452.png|250]]
그냥 next(it)이라 써도 됨

우리는 이걸 계속 써왔음. for _ in range() 안에서 기본적으로 이 작용이 계속 일어난 것.
![[Pasted image 20240730162600.png|400]]
이번에 이를 상세하게 다루는 방법을 다루는 것.
그러면 대용량 반복에서 좋은 메모리 효율을 낼 수 있다고 함.

dir(객체 or 변수)를 통해 대상의 사용 가능 메서드를 확인 할 수 있음
![[Pasted image 20240730161456.png]]
여기서 iter(), next()를 주로 이용. getitem()도 가끔 이용

i = numbers.\_\_iter__()
i = iter(numbers)
둘다 됨

![[Pasted image 20240730162851.png]]
원래 for _ in range()안에서 일어나는 것을 직접 만듬
- iter()로 현재 인스턴스를 이터레이터로 반환하여 정의
- next()는 for문에서 반복할 때마다 일어나는 것 
- 여기서 return 하는 것이 for문의 i가 되는 것
- raise StopIteration를 하면 오류를 발생시켜 for문 반복을 중단시킴(원래 이렇게 되는거라 코드가 끊기 않음).

참고로 위 클래스를 for문이 아니라 그냥 변수 여러개에 지정하는 것만으로도 가능.
![[Pasted image 20240730164306.png|200]]
하지만 개수는 정확히 맞아야 함

![[Pasted image 20240730165149.png|300]]
이런 식으로 index를 호출하는 이터레이터도 만들 수 있음.
위 코드에서 실제로 배열이 생긴 것은 아니고 그냥 getitem()로 \[]에 들어온 숫자를 그대로 출력하는 것임.

#### iter( - , - )
iter(호출 객체, 나오면 반복 끝나는 값)
![[Pasted image 20240730171003.png|400]]
아직 사용법을 잘 몰라 random말고는 떠오르는 좋은 사용 방법이 떠오리 않음.
앞이 호출 가능한 객체인데, 함수가 아니면 작동이 안됨.
그것도 매번 바뀌는 input이 적용 안됨.
아무튼 iter()뒤 숫자가 앞에서 나오는 숫자와 일치하면 반복이 끝나는 형태이다.
i 호출 가능한 매번 뱉는 값이다.
일단 원하는 결과가 나오는 것을 얻을 때 까지 반복이 필요한 작업에서는 유용할 듯.
![[Pasted image 20240730171826.png|300]]
next()와 함께 쓰이기도 함
이때 next에 기본 값을 정하면 뒤에 수를 안적어도 ㄱㅊ.


###### 연습 문항 문제 8번을 보면 좋은 응용을 볼 수 있음
참고로 next()에서 StopIteration이라는 오류를 raise하면 루프가 멈춤. 이 문제가 실제로 배열을 반복할 때 끊게 만드는거임. 그래서 외부적으로 이 오류는 튀어나오지 않음. 굳이 try를 할 필요가 없다.
만약 next() 안에 다른 오류를 집어 넣으면 그래도 외부적으로 오류가 나와서 코드가 중지 됨.

## 제네레이터
제네레이터는 이터레이터를 생성해주는 함수임
발생자라고도 함.

- 제네레이티너는 주로 클래스로 쓰이는데 얘는 함수
- 이터레이터는 클래스 안에 iter, next, getitem 등의 메서드를 정의해줘야 됨, 하지만 제네레이터는 그냥 ==yield==만 작성 하면 됨

![[Pasted image 20240730172737.png|200]]
반복까지 쉽게 작성 가능! 
별다른 조치를 취하지 않았는데 이전에 전달한 값을 전달하고 다음 값을 전달함.

dir()해보면 이터레이터 한 것 처럼 next, iter 사용 가능. 다만 getitem은 없는 듯.
![[Pasted image 20240730173051.png]]

next() 즉시 이용 가능
![[Pasted image 20240730173215.png|300]]

for 문에서 제네레이터 구조
![[Pasted image 20240730173341.png|600]]
이때 생각할 점:
![[Pasted image 20240730173601.png|500]]

yield 반복 사용도 ㄱㅊ
![[Pasted image 20240730173808.png|450]]

yield 반환 값으로 함수 넣기
![[Pasted image 20240730174257.png|400]]

yield from을 통해 하나의 yield로 여러번 바깥으로 전달 가능.
![[Pasted image 20240730204925.png|400]]
이거랑
![[Pasted image 20240730204812.png|200]]
이게 같은겨
![[Pasted image 20240730204903.png|330]]

그리고 위에 yield from이 또 전달 할 수 있는 것을 보면
이터레이터랑 제네레이터 객체도 여러번 전달 가능
yield한 함수를 from yield 할 수 있음.
![[Pasted image 20240730205242.png|350]]

![[iter_vs_gen_simple.pdf|]]